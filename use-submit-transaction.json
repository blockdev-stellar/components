{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "use-submit-transaction",
  "type": "registry:hook",
  "dependencies": [
    "@stellar/stellar-sdk"
  ],
  "files": [
    {
      "path": "registry/rei/use-submit-transaction.ts",
      "content": "import { useState } from \"react\";\nimport { TransactionBuilder, rpc } from \"@stellar/stellar-sdk\";\nimport { signTransaction } from \"~/config/wallet.client\";\nimport type { AssembledTransaction } from \"@stellar/stellar-sdk/contract\";\n\ninterface UseSubmitTransactionOptions {\n  rpcUrl: string;\n  networkPassphrase: string;\n  onSuccess?: () => void;\n  onError?: (error: unknown) => void;\n}\n\nexport function useSubmitTransaction(options: UseSubmitTransactionOptions) {\n  const [isSubmitting, setSubmitting] = useState(false);\n\n  async function submit(tx: AssembledTransaction<any>) {\n    setSubmitting(true);\n    try {\n      const builtTxXDR = tx.toXDR();\n      const signedXDR = await signTransaction(builtTxXDR);\n\n      // Submit transaction to the network\n      const server = new rpc.Server(options.rpcUrl);\n      const sentTx = await server.sendTransaction(\n        TransactionBuilder.fromXDR(signedXDR.signedTxXdr, options.networkPassphrase)\n      );\n\n      // Wait for transaction confirmation with polling\n      if (sentTx.status === \"PENDING\") {\n        const txHash = sentTx.hash;\n        let attempts = 0;\n        const maxAttempts = 10;\n\n        while (attempts < maxAttempts) {\n          await new Promise((resolve) => setTimeout(resolve, 1000));\n          try {\n            const txStatus = await server.getTransaction(txHash);\n            if (txStatus.status === \"SUCCESS\") {\n              options.onSuccess?.();\n              return { success: true };\n            } else if (txStatus.status === \"FAILED\") {\n              throw new Error(\"Transaction failed\");\n            }\n          } catch (e) {\n            // Continue polling\n          }\n          attempts++;\n        }\n\n        throw new Error(\"Transaction timeout\");\n      }\n\n      // If not pending, transaction was accepted\n      options.onSuccess?.();\n      return { success: true };\n    } catch (e) {\n      console.error(\"Transaction submission failed\", e);\n      options.onError?.(e);\n      return { success: false, error: e };\n    } finally {\n      setSubmitting(false);\n    }\n  }\n\n  return { submit, isSubmitting };\n}\n",
      "type": "registry:hook"
    }
  ]
}